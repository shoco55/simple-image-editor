import{o as R,c as F,p as j,a as H,b as m,E as Be,d as S,r as D,e as B,f as h,w as X,u as _,g as Se,h as C,q as Z,t as U,F as Q,i as I,j as O,k as Me,l as ye,m as Ae,n as Ie,s as be,v as ze,x as Le,y as ke,z as V,A as xe,B as $e}from"./vendor.3ac32152.js";const Pe=function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))t(o);new MutationObserver(o=>{for(const n of o)if(n.type==="childList")for(const r of n.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&t(r)}).observe(document,{childList:!0,subtree:!0});function e(o){const n={};return o.integrity&&(n.integrity=o.integrity),o.referrerpolicy&&(n.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?n.credentials="include":o.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function t(o){if(o.ep)return;o.ep=!0;const n=e(o);fetch(o.href,n)}};Pe();var M=(u,s)=>{const e=u.__vccOpts||u;for(const[t,o]of s)e[t]=o;return e};const Te={},Ue=u=>(j("data-v-0a5cf89d"),u=u(),H(),u),Oe={class:"app-header"},We=Ue(()=>m("h1",{class:"title"},[m("span",{class:"en"},"Simple image editor"),m("span",{class:"ja"},"- \u30C8\u30EA\u30DF\u30F3\u30B0\u30FB\u56DE\u8EE2\u30FB\u30EA\u30B5\u30A4\u30BA -")],-1)),Ve=[We];function je(u,s){return R(),F("div",Oe,Ve)}var He=M(Te,[["render",je],["__scopeId","data-v-0a5cf89d"]]);const ee=()=>({showMessage:(s,e,t)=>{Be({type:s,message:e,showClose:t})}}),Ne={class:"image-upload"},qe=m("div",{class:"el-upload__text"},[C(" \u30D5\u30A1\u30A4\u30EB\u3092\u30C9\u30ED\u30C3\u30D7 \u307E\u305F\u306F "),m("em",null,"\u30D5\u30A1\u30A4\u30EB\u3092\u9078\u629E")],-1),Ge=m("div",{class:"el-upload__tip"},[m("p",null,"\u203B\u5BFE\u5FDC\u30D5\u30A1\u30A4\u30EB\u5F62\u5F0F\uFF1Ajpg/jpeg, png"),m("p",null,"\u203B\u753B\u50CF\u306F\u30B5\u30FC\u30D0\u30FC\u306B\u306F\u4FDD\u5B58\u3055\u308C\u307E\u305B\u3093\u3002")],-1),Ke=S({emits:["goToEditor"],setup(u,{emit:s}){const{showMessage:e}=ee(),t=D(),o=a=>{a.length>1?e("warning","\u9078\u629E\u3067\u304D\u308B\u30D5\u30A1\u30A4\u30EB\u6570\u306F1\u500B\u3067\u3059\u3002",!0):(t.value.clearFiles(),t.value.handleStart(a[0]))},n=a=>{var v;const c=(v=a.raw)==null?void 0:v.type;c==="image/jpeg"||c==="image/png"?r(a):(t.value.clearFiles(),e("warning","\u753B\u50CF\u306E\u30A2\u30C3\u30D7\u30ED\u30FC\u30C9\u306F\u300Cjpg/jpeg, png\u300D\u5F62\u5F0F\u306B\u5BFE\u5FDC\u3057\u3066\u3044\u307E\u3059\u3002",!0))},r=a=>{s("goToEditor",a)},i=()=>{e("error","\u30A8\u30E9\u30FC\u304C\u767A\u751F\u3057\u307E\u3057\u305F\u3002\u3057\u3070\u3089\u304F\u7D4C\u3063\u3066\u304B\u3089\u3001\u3082\u3046\u4E00\u5EA6\u304A\u8A66\u3057\u304F\u3060\u3055\u3044\u3002",!0)};return(a,c)=>{const v=B("el-icon"),p=B("el-upload");return R(),F("div",Ne,[h(p,{ref_key:"uploadFile",ref:t,class:"upload-demo",drag:"",action:"#","auto-upload":!1,"show-file-list":!1,limit:1,"on-exceed":o,"on-change":n,"before-upload":i},{tip:X(()=>[Ge]),default:X(()=>[h(v,{class:"el-icon--upload"},{default:X(()=>[h(_(Se))]),_:1}),qe]),_:1},512)])}}});const Je={class:"image-menu"},Qe={class:"heading"},Ze=C(" \u7DE8\u96C6\u30E1\u30CB\u30E5\u30FC "),et={class:"menu"},tt=C("\u9078\u629E\u7BC4\u56F2\u3092\u30C8\u30EA\u30DF\u30F3\u30B0"),ot=C("\u53F3\u306B90\xB0\u56DE\u8EE2"),ut=C("\u5DE6\u306B90\xB0\u56DE\u8EE2"),nt=S({props:{canCrop:{type:Boolean},cropCanvasImage:null,rotateCanvasImage:null},setup(u){return(s,e)=>{const t=B("el-button"),o=B("el-tooltip");return R(),F("div",Je,[m("h2",Qe,[Ze,h(o,{content:"\u753B\u50CF\u3092\u30C8\u30EA\u30DF\u30F3\u30B0\u3059\u308B\u306B\u306F\u3001\u753B\u50CF\u4E0A\u3092\u30AF\u30EA\u30C3\u30AF\u3057\u3066\u304B\u3089\u30C9\u30E9\u30C3\u30B0\u3067\u7BC4\u56F2\u3092\u9078\u629E\u3057\u3066\u3001<br>\u300C\u9078\u629E\u7BC4\u56F2\u3092\u30C8\u30EA\u30DF\u30F3\u30B0\u300D\u30DC\u30BF\u30F3\u3092\u62BC\u4E0B\u3057\u3066\u304F\u3060\u3055\u3044\u3002<br>\u9078\u629E\u7BC4\u56F2\u306E\u30B5\u30A4\u30BA\u306F\u300C\u7DE8\u96C6\u60C5\u5831\u300D\u3067\u78BA\u8A8D\u3067\u304D\u307E\u3059\u3002","raw-content":"",placement:"top-start"},{default:X(()=>[h(t,{class:"tooltipIcon",icon:_(Z),circle:""},null,8,["icon"])]),_:1})]),m("div",et,[h(t,{type:"primary",plain:"",disabled:!u.canCrop,onClick:u.cropCanvasImage},{default:X(()=>[tt]),_:1},8,["disabled","onClick"]),h(t,{type:"primary",plain:"",onClick:e[0]||(e[0]=n=>u.rotateCanvasImage("right"))},{default:X(()=>[ot]),_:1}),h(t,{type:"primary",plain:"",onClick:e[1]||(e[1]=n=>u.rotateCanvasImage("left"))},{default:X(()=>[ut]),_:1})])])}}});var at=M(nt,[["__scopeId","data-v-c4167fa8"]]);const st=u=>(j("data-v-60cd1e6a"),u=u(),H(),u),rt={class:"image-information"},it=st(()=>m("h2",{class:"heading"},"\u7DE8\u96C6\u60C5\u5831",-1)),ct={class:"text"},lt={class:"text"},dt=C(" \u9078\u629E\u7BC4\u56F2\uFF1A "),mt=C("\u672A\u9078\u629E"),pt=S({props:{imageSize:null,canvasState:null},setup(u){return(s,e)=>(R(),F("div",rt,[it,m("p",ct," \u73FE\u5728\u306E\u30B5\u30A4\u30BA\uFF1A"+U(u.imageSize.current.width)+" \xD7 "+U(u.imageSize.current.height)+" px ",1),m("p",lt,[dt,u.canvasState.hasRect?(R(),F(Q,{key:0},[C(U(u.imageSize.crop.width)+" \xD7 "+U(u.imageSize.crop.height)+" px",1)],64)):(R(),F(Q,{key:1},[mt],64))])]))}});var vt=M(pt,[["__scopeId","data-v-60cd1e6a"]]);const N=u=>(j("data-v-1dd02f30"),u=u(),H(),u),ht={class:"image-resize"},gt={class:"heading"},Et=C(" \u30EA\u30B5\u30A4\u30BA "),_t={class:"resize-form"},ft=N(()=>m("span",{class:"label"},"\u65B0\u898F\u30B5\u30A4\u30BA\uFF1A",-1)),wt={class:"content"},Rt=N(()=>m("span",null,"\xD7",-1)),Ct=N(()=>m("span",null,"px",-1)),Xt={class:"resizeButton"},Yt=C("\u65B0\u898F\u30B5\u30A4\u30BA\u306B\u5909\u66F4"),Ft=S({props:{imageSize:null,updateImageResize:null,resizeCanvasImage:null},setup(u){const s=u,e=I({width:0,height:0});O(()=>{e.width=s.imageSize.resize.width,e.height=s.imageSize.resize.height});const t=r=>{n(r,"width")},o=r=>{n(r,"height")},n=(r,i)=>{const a=i==="width"?"height":"width",c=r/s.imageSize.current[i];e[a]=Math.round(s.imageSize.current[a]*c),s.updateImageResize(e.width,e.height)};return(r,i)=>{const a=B("el-button"),c=B("el-tooltip"),v=B("el-input-number");return R(),F("div",ht,[m("h2",gt,[Et,h(c,{content:"\u5143\u306E\u753B\u50CF\u306E\u30B5\u30A4\u30BA\u6BD4\u7387\u3092\u4FDD\u3063\u305F\u307E\u307E\u3001\u30B5\u30A4\u30BA\u3092\u5909\u66F4\u3067\u304D\u307E\u3059\u3002<br>\u73FE\u5728\u306E\u30B5\u30A4\u30BA\u3088\u308A\u62E1\u5927\u3059\u308B\u3053\u3068\u306F\u3067\u304D\u307E\u305B\u3093\u3002<br><br>\u30C8\u30EA\u30DF\u30F3\u30B0\u7BC4\u56F2\u9078\u629E\u4E2D\u306B\u30EA\u30B5\u30A4\u30BA\u3059\u308B\u3068\u3001\u9078\u629E\u7BC4\u56F2\u304C\u89E3\u9664\u3055\u308C\u307E\u3059\u3002<br>\u30C8\u30EA\u30DF\u30F3\u30B0\u5F8C\u306B\u7E2E\u5C3A\u306E\u5909\u66F4\u3092\u884C\u3044\u305F\u3044\u5834\u5408\u306F\u3001<br>\u7BC4\u56F2\u9078\u629E\u5F8C\u306B\u300C\u9078\u629E\u7BC4\u56F2\u3092\u30C8\u30EA\u30DF\u30F3\u30B0\u300D\u3092\u62BC\u4E0B\u3057\u3066\u304B\u3089\u3001<br>\u30EA\u30B5\u30A4\u30BA\u3092\u884C\u3063\u3066\u4E0B\u3055\u3044\u3002","raw-content":"",placement:"top-start"},{default:X(()=>[h(a,{class:"tooltipIcon",icon:_(Z),circle:""},null,8,["icon"])]),_:1})]),m("div",_t,[ft,m("div",wt,[h(v,{modelValue:_(e).width,"onUpdate:modelValue":i[0]||(i[0]=p=>_(e).width=p),min:1,max:u.imageSize.current.width,"controls-position":"right",onChange:t},null,8,["modelValue","max"]),Rt,h(v,{modelValue:_(e).height,"onUpdate:modelValue":i[1]||(i[1]=p=>_(e).height=p),min:1,max:u.imageSize.current.height,"controls-position":"right",onChange:o},null,8,["modelValue","max"]),Ct])]),m("div",Xt,[h(a,{type:"primary",plain:"",onClick:u.resizeCanvasImage},{default:X(()=>[Yt]),_:1},8,["onClick"])])])}}});var Dt=M(Ft,[["__scopeId","data-v-1dd02f30"]]);const Bt=()=>{const u=I({originalImageFile:void 0}),s=i=>{u.originalImageFile=i},e=I({current:{width:0,height:0},crop:{width:0,height:0},resize:{width:0,height:0}}),t=Me(()=>e.crop.width>0&&e.crop.height>0),o=(i,a)=>{e.current.width=i,e.current.height=a},n=(i,a)=>{e.crop.width=i,e.crop.height=a},r=(i,a)=>{e.resize.width=i,e.resize.height=a};return O(()=>{r(e.current.width,e.current.height)}),{imageData:u,updateOriginalImageFile:s,imageSize:e,canCrop:t,updateImageCurrentSize:o,updateImageCropSize:n,updateImageResize:r}},St=()=>{const u=I({displayReductionRatio:1,clickableRange:16,isMouseDown:!1,hasRect:!1});return{canvasState:u,calculateDisplayReductionRatio:(o,n)=>{u.displayReductionRatio=o/n},updateIsMouseDown:o=>{u.isMouseDown=o},updateHasRect:o=>{u.hasRect=o}}},Mt=(u,s)=>{const e=I({mouseDownX:0,mouseDownY:0,mouseMoveX:0,mouseMoveY:0,tempRectStartX:0,tempRectStartY:0,tempRectEndX:0,tempRectEndY:0,rectStartX:0,rectStartY:0,rectEndX:0,rectEndY:0});return{canvasPosition:e,getMouseDownPosition:(a,c)=>{const v=window.pageXOffset+c.left,p=window.pageYOffset+c.top,y=a.pageX-v,A=a.pageY-p;e.mouseDownX=Math.round(y/s.displayReductionRatio),e.mouseDownY=Math.round(A/s.displayReductionRatio)},getMouseMovePosition:(a,c)=>{const v=window.pageXOffset+c.left,p=window.pageYOffset+c.top,y=a.pageX-v,A=a.pageY-p;e.mouseMoveX=Math.round(y/s.displayReductionRatio),e.mouseMoveY=Math.round(A/s.displayReductionRatio);const E={topLeft:e.mouseMoveX<0&&e.mouseMoveY<0,topRight:u.current.width<e.mouseMoveX&&e.mouseMoveY<0,bottomRight:u.current.width<e.mouseMoveX&&u.current.height<e.mouseMoveY,bottomLeft:e.mouseMoveX<0&&u.current.height<e.mouseMoveY,top:e.mouseMoveY<0,right:u.current.width<e.mouseMoveX,bottom:u.current.height<e.mouseMoveY,left:e.mouseMoveX<0};E.topLeft?(e.mouseMoveX=0,e.mouseMoveY=0):E.topRight?(e.mouseMoveX=u.current.width,e.mouseMoveY=0):E.bottomRight?(e.mouseMoveX=u.current.width,e.mouseMoveY=u.current.height):E.bottomLeft?(e.mouseMoveX=0,e.mouseMoveY=u.current.height):E.top?e.mouseMoveY=0:E.right?e.mouseMoveX=u.current.width:E.bottom?e.mouseMoveY=u.current.height:E.left&&(e.mouseMoveX=0)},getCanvasRectSize:()=>{const a=s.clickableRange,c={fromTopLeft:e.rectStartX-a<e.mouseDownX&&e.mouseDownX<e.rectStartX+a&&e.rectStartY-a<e.mouseDownY&&e.mouseDownY<e.rectStartY+a,fromTopRight:e.rectEndX-a<e.mouseDownX&&e.mouseDownX<e.rectEndX+a&&e.rectStartY-a<e.mouseDownY&&e.mouseDownY<e.rectStartY+a,fromBottomRight:e.rectEndX-a<e.mouseDownX&&e.mouseDownX<e.rectEndX+a&&e.rectEndY-a<e.mouseDownY&&e.mouseDownY<e.rectEndY+a,fromBottomLeft:e.rectStartX-a<e.mouseDownX&&e.mouseDownX<e.rectStartX+a&&e.rectEndY-a<e.mouseDownY&&e.mouseDownY<e.rectEndY+a,fromTop:e.rectStartX-a<e.mouseDownX&&e.mouseDownX<e.rectEndX+a&&e.rectStartY-a<e.mouseDownY&&e.mouseDownY<e.rectStartY+a,fromRight:e.rectEndX-a<e.mouseDownX&&e.mouseDownX<e.rectEndX+a&&e.rectStartY-a<e.mouseDownY&&e.mouseDownY<e.rectEndY+a,fromBottom:e.rectStartX-a<e.mouseDownX&&e.mouseDownX<e.rectEndX+a&&e.rectEndY-a<e.mouseDownY&&e.mouseDownY<e.rectEndY+a,fromLeft:e.rectStartX-a<e.mouseDownX&&e.mouseDownX<e.rectStartX+a&&e.rectStartY-a<e.mouseDownY&&e.mouseDownY<e.rectEndY+a};c.fromTopLeft?(e.mouseMoveX<e.rectEndX?(e.tempRectStartX=e.mouseMoveX,e.tempRectEndX=e.rectEndX):(e.tempRectStartX=e.rectEndX,e.tempRectEndX=e.mouseMoveX),e.mouseMoveY<e.rectEndY?(e.tempRectStartY=e.mouseMoveY,e.tempRectEndY=e.rectEndY):(e.tempRectStartY=e.rectEndY,e.tempRectEndY=e.mouseMoveY)):c.fromTopRight?(e.rectStartX<e.mouseMoveX?(e.tempRectStartX=e.rectStartX,e.tempRectEndX=e.mouseMoveX):(e.tempRectStartX=e.mouseMoveX,e.tempRectEndX=e.rectStartX),e.mouseMoveY<e.rectEndY?(e.tempRectStartY=e.mouseMoveY,e.tempRectEndY=e.rectEndY):(e.tempRectStartY=e.rectEndY,e.tempRectEndY=e.mouseMoveY)):c.fromBottomRight?(e.rectStartX<e.mouseMoveX?(e.tempRectStartX=e.rectStartX,e.tempRectEndX=e.mouseMoveX):(e.tempRectStartX=e.mouseMoveX,e.tempRectEndX=e.rectStartX),e.rectStartY<e.mouseMoveY?(e.tempRectStartY=e.rectStartY,e.tempRectEndY=e.mouseMoveY):(e.tempRectStartY=e.mouseMoveY,e.tempRectEndY=e.rectStartY)):c.fromBottomLeft?(e.mouseMoveX<e.rectEndX?(e.tempRectStartX=e.mouseMoveX,e.tempRectEndX=e.rectEndX):(e.tempRectStartX=e.rectEndX,e.tempRectEndX=e.mouseMoveX),e.rectStartY<e.mouseMoveY?(e.tempRectStartY=e.rectStartY,e.tempRectEndY=e.mouseMoveY):(e.tempRectStartY=e.mouseMoveY,e.tempRectEndY=e.rectStartY)):c.fromTop?(e.tempRectStartX=e.rectStartX,e.tempRectEndX=e.rectEndX,e.mouseMoveY<e.rectEndY?(e.tempRectStartY=e.mouseMoveY,e.tempRectEndY=e.rectEndY):(e.tempRectStartY=e.rectEndY,e.tempRectEndY=e.mouseMoveY)):c.fromRight?(e.rectStartX<e.mouseMoveX?(e.tempRectStartX=e.rectStartX,e.tempRectEndX=e.mouseMoveX):(e.tempRectStartX=e.mouseMoveX,e.tempRectEndX=e.rectStartX),e.tempRectStartY=e.rectStartY,e.tempRectEndY=e.rectEndY):c.fromBottom?(e.tempRectStartX=e.rectStartX,e.tempRectEndX=e.rectEndX,e.rectStartY<e.mouseMoveY?(e.tempRectStartY=e.rectStartY,e.tempRectEndY=e.mouseMoveY):(e.tempRectStartY=e.mouseMoveY,e.tempRectEndY=e.rectStartY)):c.fromLeft?(e.mouseMoveX<e.rectEndX?(e.tempRectStartX=e.mouseMoveX,e.tempRectEndX=e.rectEndX):(e.tempRectStartX=e.rectEndX,e.tempRectEndX=e.mouseMoveX),e.tempRectStartY=e.rectStartY,e.tempRectEndY=e.rectEndY):(e.mouseDownX<e.mouseMoveX?(e.tempRectStartX=e.mouseDownX,e.tempRectEndX=e.mouseMoveX):(e.tempRectStartX=e.mouseMoveX,e.tempRectEndX=e.mouseDownX),e.mouseDownY<e.mouseMoveY?(e.tempRectStartY=e.mouseDownY,e.tempRectEndY=e.mouseMoveY):(e.tempRectStartY=e.mouseMoveY,e.tempRectEndY=e.mouseDownY));const v=e.tempRectEndX-e.tempRectStartX,p=e.tempRectEndY-e.tempRectStartY;return{width:v,height:p}},saveRectPosition:()=>{e.rectStartX=e.tempRectStartX,e.rectEndX=e.tempRectEndX,e.rectStartY=e.tempRectStartY,e.rectEndY=e.tempRectEndY},initializeRectPosition:()=>{e.tempRectStartX=0,e.tempRectStartY=0,e.tempRectEndX=0,e.tempRectEndY=0,e.rectStartX=0,e.rectStartY=0,e.rectEndX=0,e.rectEndY=0}}},yt=(u,s)=>({getCanvasCursorStyle:()=>{const{clickableRange:t}=u,{mouseMoveX:o,mouseMoveY:n,rectStartX:r,rectStartY:i,rectEndX:a,rectEndY:c}=s;let v="crosshair";if(u.hasRect){const p={topLeft:r-t<o&&o<r+t&&i-t<n&&n<i+t,topRight:a-t<o&&o<a+t&&i-t<n&&n<i+t,bottomRight:a-t<o&&o<a+t&&c-t<n&&n<c+t,bottomLeft:r-t<o&&o<r+t&&c-t<n&&n<c+t,top:r-t<o&&o<a+t&&i-t<n&&n<i+t,right:a-t<o&&o<a+t&&i-t<n&&n<c+t,bottom:r-t<o&&o<a+t&&c-t<n&&n<c+t,left:r-t<o&&o<r+t&&i-t<n&&n<c+t};p.topLeft||p.bottomRight?v="nwse-resize":p.topRight||p.bottomLeft?v="nesw-resize":p.top||p.bottom?v="ns-resize":(p.right||p.left)&&(v="ew-resize")}return v}}),At=()=>({loadFileReader:s=>new Promise((e,t)=>{const o=new FileReader;o.onload=n=>{var r;return e((r=n.target)==null?void 0:r.result)},o.onerror=n=>t(n),o.readAsDataURL(s)})}),It=()=>({loadImage:s=>new Promise((e,t)=>{const o=new Image;o.onload=()=>e(o),o.onerror=n=>t(n),o.src=s})}),bt=()=>({downloadFile:(s,e)=>{const t=document.createElement("a");t.href=window.URL.createObjectURL(s),t.download=e,t.click()}}),zt=()=>({convertBase64toBlob:(s,e)=>{const t=s.split(","),o=atob(t[1]),n=new Uint8Array(o.length);for(let i=0;i<o.length;i++)n[i]=o.charCodeAt(i);return new Blob([n],{type:e})}}),Lt=()=>{const u=D(!0);return{isLoading:u,openLoading:()=>{u.value=!0},closeLoading:()=>{u.value=!1}}};const kt={class:"image-operations"},xt=C("\u30EA\u30BB\u30C3\u30C8"),$t=C("\u7DE8\u96C6\u3057\u305F\u753B\u50CF\u3092\u30C0\u30A6\u30F3\u30ED\u30FC\u30C9"),Pt=S({props:{resetCanvasImage:null,onClickDownload:null},setup(u){return(s,e)=>{const t=B("el-button");return R(),F("div",kt,[h(t,{class:"resetButton",plain:"",icon:_(ye),onClick:u.resetCanvasImage},{default:X(()=>[xt]),_:1},8,["icon","onClick"]),h(t,{type:"primary",icon:_(Ae),onClick:u.onClickDownload},{default:X(()=>[$t]),_:1},8,["icon","onClick"])])}}});var Tt=M(Pt,[["__scopeId","data-v-1c1094da"]]);const Ut={style:{width:"100%"},class:"image-editor"},Ot={class:"image-editor-layout"},Wt={class:"image-editor-main"},Vt={class:"image-canvas"},jt={class:"operations"},Ht=C(" \u753B\u50CF\u3092\u9078\u629E\u3057\u76F4\u3059 "),Nt={class:"image-editor-panel"},qt={class:"panel-block"},Gt={class:"panel-block"},Kt=S({props:{uploadFile:null,returnUploader:null},setup(u){const s=u;Ie(()=>{K()});const e=D(),t=D(),o=D(),n=D(),r=D();O(()=>{t.value!==void 0&&n.value!==void 0&&(n.value.width=t.value.width,n.value.height=t.value.height)});const{imageData:i,updateOriginalImageFile:a,imageSize:c,canCrop:v,updateImageCurrentSize:p,updateImageCropSize:y,updateImageResize:A}=Bt(),{canvasState:E,calculateDisplayReductionRatio:oe,updateIsMouseDown:q,updateHasRect:G}=St(),{canvasPosition:Y,getMouseDownPosition:ue,getMouseMovePosition:ne,getCanvasRectSize:ae,saveRectPosition:se,initializeRectPosition:re}=Mt(c,E),{getCanvasCursorStyle:ie}=yt(E,Y),{loadImage:b}=It(),{loadFileReader:ce}=At(),{downloadFile:le}=bt(),{convertBase64toBlob:de}=zt(),{isLoading:me,openLoading:z,closeLoading:L}=Lt(),{showMessage:k}=ee(),pe=(l,d)=>{e.value!==void 0&&(e.value.style.width=l*E.displayReductionRatio+"px",e.value.style.height=d*E.displayReductionRatio+"px")},ve=(l,d)=>{t.value!==void 0&&(t.value.width=l,t.value.height=d,n.value!==void 0&&(n.value.width=l,n.value.height=d))};O(()=>{const l=Y.tempRectEndX-Y.tempRectStartX,d=Y.tempRectEndY-Y.tempRectStartY;y(l,d)});const he=()=>{t.value!==void 0&&oe(t.value.clientWidth,t.value.width)},x=(l,d)=>{ve(l,d),p(l,d),he(),pe(l,d)},K=async()=>{var l,d;try{if(z(),a((l=s.uploadFile)==null?void 0:l.raw),i.originalImageFile===void 0)throw new Error;const f=await ce(i.originalImageFile),g=await b(f),w=g.width,T=g.height;if(t.value===void 0||n.value===void 0)return;o.value=t.value.getContext("2d"),r.value=n.value.getContext("2d"),x(w,T),(d=o.value)==null||d.drawImage(g,0,0)}catch{k("error","\u753B\u50CF\u306E\u8AAD\u307F\u8FBC\u307F\u306B\u5931\u6557\u3057\u307E\u3057\u305F\u3002\u30A2\u30D7\u30EA\u306E\u4E0D\u5177\u5408\u306E\u53EF\u80FD\u6027\u304C\u3042\u308B\u305F\u3081\u3001\u30A2\u30D7\u30EA\u7BA1\u7406\u8005\u306B\u3054\u9023\u7D61\u304F\u3060\u3055\u3044\u3002",!0),s.returnUploader()}finally{L()}},$=()=>{re(),G(!1)},ge=()=>{J(),$(),K()},J=()=>{n.value!==void 0&&r.value!=null&&r.value.clearRect(0,0,n.value.width,n.value.height)},Ee=l=>{if(q(!0),t.value!==void 0){const d=t.value.getBoundingClientRect();ue(l,d)}window.addEventListener("mousemove",P),window.addEventListener("mouseup",W)},_e=()=>{if(n.value===void 0||r.value==null)return;const l={fillStyle:"rgba("+[0,0,0,.6]+")",strokeStyle:"white",setLineDash:[20,10],lineWidth:4};r.value.fillStyle=l.fillStyle,r.value.fillRect(0,0,n.value.width,n.value.height)},fe=()=>{if(n.value===void 0||r.value==null)return;G(!0);const l={strokeStyle:"white",setLineDash:[20,10],lineWidth:4};r.value.strokeStyle=l.strokeStyle,r.value.setLineDash(l.setLineDash),r.value.lineWidth=l.lineWidth;const{width:d,height:f}=ae(),g=l.lineWidth,w=l.lineWidth/2;r.value.strokeRect(Y.tempRectStartX,Y.tempRectStartY,d,f),r.value.clearRect(Y.tempRectStartX+w,Y.tempRectStartY+w,d-g,f-g)},P=l=>{if(t.value!==void 0){const d=t.value.getBoundingClientRect();ne(l,d)}!E.isMouseDown||(J(),_e(),fe())},we=()=>{if(n.value===void 0)return;const l=ie();n.value.style.cursor=l},Re=l=>{E.isMouseDown||(P(l),we())},W=()=>{window.removeEventListener("mousemove",P),q(!1),window.removeEventListener("mouseup",W),se()},Ce=async()=>{var l;if(!(c.crop.width===0||c.crop.height===0))try{if(z(),t.value===void 0||o.value==null)return;const d=t.value.toDataURL((l=i.originalImageFile)==null?void 0:l.type),f=await b(d),g=c.crop.width,w=c.crop.height;x(g,w),o.value.drawImage(f,Y.rectStartX,Y.rectStartY,g,w,0,0,g,w),$()}catch{k("error","\u753B\u50CF\u306E\u30C8\u30EA\u30DF\u30F3\u30B0\u306B\u5931\u6557\u3057\u307E\u3057\u305F\u3002\u30A2\u30D7\u30EA\u306E\u4E0D\u5177\u5408\u306E\u53EF\u80FD\u6027\u304C\u3042\u308B\u305F\u3081\u3001\u30A2\u30D7\u30EA\u7BA1\u7406\u8005\u306B\u3054\u9023\u7D61\u304F\u3060\u3055\u3044\u3002",!0)}finally{L()}},Xe=async l=>{var d;try{if(z(),t.value===void 0)return;const f=t.value.toDataURL((d=i.originalImageFile)==null?void 0:d.type),g=await b(f),w=t.value.height,T=t.value.width;x(w,T);const De=l==="right"?90:-90;if(o.value==null)return;o.value.save(),o.value.translate(w/2,T/2),o.value.rotate(De*Math.PI/180),o.value.translate(-g.width/2,-g.height/2),o.value.drawImage(g,0,0),o.value.restore(),$()}catch{k("error","\u753B\u50CF\u306E\u56DE\u8EE2\u306B\u5931\u6557\u3057\u307E\u3057\u305F\u3002\u30A2\u30D7\u30EA\u306E\u4E0D\u5177\u5408\u306E\u53EF\u80FD\u6027\u304C\u3042\u308B\u305F\u3081\u3001\u30A2\u30D7\u30EA\u7BA1\u7406\u8005\u306B\u3054\u9023\u7D61\u304F\u3060\u3055\u3044\u3002",!0)}finally{L()}},Ye=async()=>{var l;try{if(z(),t.value===void 0)return;const d=t.value.toDataURL((l=i.originalImageFile)==null?void 0:l.type),f=await b(d);if(o.value==null)return;const g=c.resize.width,w=c.resize.height;x(g,w),o.value.drawImage(f,0,0,g,w),$()}catch{k("error","\u753B\u50CF\u306E\u30EA\u30B5\u30A4\u30BA\u306B\u5931\u6557\u3057\u307E\u3057\u305F\u3002\u30A2\u30D7\u30EA\u306E\u4E0D\u5177\u5408\u306E\u53EF\u80FD\u6027\u304C\u3042\u308B\u305F\u3081\u3001\u30A2\u30D7\u30EA\u7BA1\u7406\u8005\u306B\u3054\u9023\u7D61\u304F\u3060\u3055\u3044\u3002",!0)}finally{L()}},Fe=()=>{if(t.value===void 0||i.originalImageFile===void 0)return;const l=t.value.toDataURL(i.originalImageFile.type),d=i.originalImageFile.name,f=de(l,d);le(f,d)};return be(()=>{window.removeEventListener("mousemove",P),window.removeEventListener("mouseup",W)}),(l,d)=>{const f=B("el-button"),g=ze("loading");return Le((R(),F("div",Ut,[m("div",Ot,[m("div",Wt,[h(at,{"can-crop":_(v),"crop-canvas-image":Ce,"rotate-canvas-image":Xe},null,8,["can-crop"]),m("div",Vt,[m("div",{ref_key:"canvasContainer",ref:e,class:"image-canvas-container"},[m("canvas",{ref_key:"displayCanvas",ref:t,class:"display"},null,512),m("canvas",{ref_key:"drawingCanvas",ref:n,class:"drawing",onMousedown:Ee,onMousemove:Re},null,544)],512)]),m("div",jt,[h(Tt,{"reset-canvas-image":ge,"on-click-download":Fe})]),h(f,{class:"returnButton",type:"text",plain:"",icon:_(ke),onClick:u.returnUploader},{default:X(()=>[Ht]),_:1},8,["icon","onClick"])]),m("div",Nt,[m("div",qt,[h(vt,{"image-size":_(c),"canvas-state":_(E)},null,8,["image-size","canvas-state"])]),m("div",Gt,[h(Dt,{"image-size":_(c),"update-image-resize":_(A),"resize-canvas-image":Ye},null,8,["image-size","update-image-resize"])])])])])),[[g,_(me)]])}}});var Jt=M(Kt,[["__scopeId","data-v-aa24c69e"]]);const Qt={class:"app-wrapper"},Zt={class:"app-main"},eo=S({setup(u){const s=D("uploader"),e=D(void 0),t=n=>{e.value=n,s.value="editor"},o=()=>{s.value="uploader"};return(n,r)=>(R(),F("div",Qt,[h(He),m("main",Zt,[s.value==="uploader"?(R(),V(Ke,{key:0,onGoToEditor:t})):(R(),V(Jt,{key:1,"upload-file":e.value,"return-uploader":o},null,8,["upload-file"]))])]))}});var to=M(eo,[["__scopeId","data-v-fe623710"]]);const oo=S({setup(u){return(s,e)=>(R(),V(to))}});const te=xe(oo);te.use($e);te.mount("#app");
